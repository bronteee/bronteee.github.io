<!DOCTYPE html>
<html>
  <head>
    <title>Week 3 | Unet and Baseline Results – Improving Wildfire Prediction and Vegetation Recovery Modeling with Explainable AI – This is the project site for wildfire modeling by Bronte Sihan Li, MLS(ASCP). You can find project descriptions, documentation and useful links here. This site will be continuously updated throughout the duration of the project.</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task.

" />
    <meta property="og:description" content="Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task.

" />
    
    <meta name="author" content="Improving Wildfire Prediction and Vegetation Recovery Modeling with Explainable AI" />

    
    <meta property="og:title" content="Week 3 | Unet and Baseline Results" />
    <meta property="twitter:title" content="Week 3 | Unet and Baseline Results" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Improving Wildfire Prediction and Vegetation Recovery Modeling with Explainable AI - This is the project site for wildfire modeling by Bronte Sihan Li, MLS(ASCP). You can find project descriptions, documentation and useful links here. This site will be continuously updated throughout the duration of the project." href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="https://bronteee.github.io/images/headshot.JPG" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Improving Wildfire Prediction and Vegetation Recovery Modeling with Explainable AI</a></h1>
            <p class="site-description">This is the project site for wildfire modeling by Bronte Sihan Li, MLS(ASCP). You can find project descriptions, documentation and useful links here. This site will be continuously updated throughout the duration of the project.</p>
          </div>

        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Week 3 | Unet and Baseline Results</h1>

  <div class="entry">
    <p>Now that we have our dataset ready, it is time to obtain some baseline results with the goal of 1/ evaluate the difficulty of the problem and 2/ determine if the problem is framed correctly. With that in mind, we will be using the Unet architecture as the starting architecture for this segmentation task.</p>

<h2 id="framing-of-the-problem">Framing of the Problem</h2>

<p>Before we get into the solution, let’s take a step back and look at the problem we are trying to solve in the context of deep learning. As we saw last week, we are given a 3D tensor of shape (12, 64, 64) as input, and we are trying to predict a 2D tensor of shape (64, 64) as output, which is our next day fire mask. We can think of this as a segmentation problem, where the task is classification of each output pixel as either 0 or 1, where 0 means no fire and 1 means fire. So how do we know how good the prediction is? Two common metrics for segmentation tasks are the <a href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient">Dice coefficient</a> and the <a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard index</a>.</p>

<p>Given two sets X and Y, Dice coefficient is defined as:</p>

<p><img src="/images/dice_coefficient.png" alt="dice_coefficient" /></p>

<p>Whereas similarly, the Jaccard index is defined as:</p>

<p><img src="/images/jaccard_index.png" alt="jaccard_index" /></p>

<p>In the context of our fire spread prediction, we can think of the ground truth fire mask as a set of pixels A and the predicted fire mask as a set of pixels B. Then, the Dice coefficient and Jaccard index can be used to evaluate the accuracy of the prediction. The higher the value, the better the prediction.</p>

<h2 id="unet">Unet</h2>

<p>Unet is a simple yet powerful architecture originally developed for biomedical imaging segmentation tasks. It is composed of an encoder and a decoder, where the encoder is a series of convolutional layers that downsample the input, and the decoder is a series of convolutional layers that upsample the input. The encoder and decoder are connected by skip connections, which allow the decoder to use information from the encoder to improve the segmentation results. The architecture is shown below:</p>

<p><img src="/images/u-net-architecture.png" alt="unet_image" /></p>

<p>Using this network allows us to get some initial results relatively fast to get a handle on the problem of predicting wildfire spread, and if the results are promising, we can then explore more sophisticated architectures.</p>

<h2 id="baseline-results">Baseline Results</h2>

<p>Due to the large size of the dataset and limited GPU resources, we downsampled the dataset from 64x64 to 32x32 and only used the 3 most important dimensions discovered in the original dataset paper: previous day fire mask, vegetation, and elevation. For the loss function, we used binary cross entropy with a positive weight of 100 to account for the imbalance between fire and no fire pixels, and for the optimizer, we used the default Unet scheduler with a learning rate of 1e-5.</p>

<p>The model was trained on an A800-80G GPU for 10 epochs, and we obtained the following results:</p>

<p><img src="/images/train_loss_unet.png" alt="train_loss_unet" />
<img src="/images/validation_unet.png" alt="validation_unet" /></p>

<p>As shown here in the results, we can see that unfortunately the dice score is plateauing at around 0.18, which is not very good. There are a few possible explanations, including the fact that the model is too simple, or the problem is not framed correctly. We will explore these possibilities in the next few weeks.</p>

<h2 id="next-steps">Next Steps</h2>

<p>Next week, we will be exploring the possibility of:</p>

<ol>
  <li>Preprocessing in different ways the input and target labels to improve the results, for example, by using a different representation of the target labels including using the change in fire rather than fire/no fire. Another idea is to only predict the surrounding the current fire perimeter rather than the entire image, mentioned in the <a href="https://www.ijcai.org/proceedings/2019/636">FireCast paper</a>.</li>
  <li>Applying a different loss function that may better reflect the nature of the problem by reviewing and trying out implementations <a href="https://github.com/shruti-jadon/Semantic-Segmentation-Loss-Functions">here</a>.</li>
</ol>

  </div>

  <div class="date">
    Written on September 25, 2023
  </div>

</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:li.siha [at] northeastern [dot] edu"><i class="svg-icon email"></i></a>




<a href="https://www.linkedin.com/in/https://www.linkedin.com/in/brontesihanli/"><i class="svg-icon linkedin"></i></a>






        </footer>
      </div>
    </div>

  </body>
</html>
